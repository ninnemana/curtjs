{"ts":1373229859904,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"$.support.cors = true;\n\nvar API_DOMAIN = 'http://goapi.curtmfg.com',\nAPI_KEY    = '8aee0620-412e-47fc-900a-947820ea1c1d';\n\nvar CurtVehicle = function(){\n    return this;\n};\n\nCurtVehicle.prototype = {\n\tyear: 0,\n\tmake: '',\n\tmodel: '',\n\tsubmodel: '',\n\tconfiguration: [], // []string\n\tparts: [], // []Part\n\tgroups: [], // []int\n\treset: function(callback){\n\t\tthis.year = 0;\n\t\tthis.make = this.model = this.submodel = '';\n\t\tthis.configuration = this.parts = this.groups = [];\n\n\t\tif(callback){\n\t\t\tcallback();\n\t\t}\n\t},\n\tget_years: function(callback){\n\t\tthis.year = 0;\n\t\tthis.make = this.model = this.submodel = '';\n\t\tthis.configuration = this.parts = this.groups = [];\n\n\t\t$.ajax({\n\t\t\turl: API_DOMAIN + '/vehicle',\n\t\t\ttype: 'get',\n\t\t\tdataType:'json',\n\t\t\tdata: {\n\t\t\t\tkey: API_KEY\n\t\t\t},\n\t\t\tsuccess: function(data, status, xhr){\n\t\t\t\tif (data.ConfigOption !== undefined && data.ConfigOption.Options !== undefined && data.ConfigOption.Options.length > 0){\n\t\t\t\t\tcallback(data.ConfigOption.Options, null);\n\t\t\t\t}else{\n\t\t\t\t\tcallback([],\"Failed to retrieve vehicle years\");\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(xhr,status,err){\n\t\t\t\tcallback([],err);\n\t\t\t}\n\t\t});\n\t},\n\tget_makes: function(callback){\n\t\tthis.make = this.model = this.submodel = '';\n\t\tthis.configuration = this.parts = this.groups = [];\n\n\t\t$.ajax({\n\t\t\turl: API_DOMAIN + '/vehicle/' + this.year,\n\t\t\ttype:'get',\n\t\t\tdataType:'json',\n\t\t\tdata:{\n\t\t\t\tkey: API_KEY\n\t\t\t},\n\t\t\tsuccess: function(data, status, xhr){\n\t\t\t\tif (data.ConfigOption !== undefined && data.ConfigOption.Options !== undefined && data.ConfigOption.Options.length > 0){\n\t\t\t\t\tcallback(data.ConfigOption.Options, null);\n\t\t\t\t}else{\n\t\t\t\t\tcallback([],\"Failed to retrieve vehicle makes\");\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(xhr,status,err){\n\t\t\t\tcallback([],err);\n\t\t\t}\n\t\t});\n\t}\n\t,\n\tget_models: function(callback){\n\t\tthis.model = this.submodel = '';\n\t\tthis.configuration = this.parts = this.groups = [];\n\n\t\t$.ajax({\n\t\t\turl: API_DOMAIN + '/vehicle/' + this.year +'/' + this.make,\n\t\t\ttype:'get',\n\t\t\tdataType:'json',\n\t\t\tdata:{\n\t\t\t\tkey: API_KEY\n\t\t\t},\n\t\t\tsuccess: function(data, status, xhr){\n\t\t\t\tif(data.Matched.Parts !== null && data.Matched.Parts.length > 0){\n\t\t\t\t\tthis.parts = data.Matched.Parts;\n\t\t\t\t\tthis.groups = data.Matched.Groups;\n\t\t\t\t}\n\t\t\t\tif (data.ConfigOption !== undefined && data.ConfigOption.Options !== undefined && data.ConfigOption.Options.length > 0){\n\t\t\t\t\tcallback(data.ConfigOption.Options, null);\n\t\t\t\t}else{\n\t\t\t\t\tcallback([],\"Failed to retrieve vehicle models\");\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(xhr,status,err){\n\t\t\t\tcallback([],err);\n\t\t\t}\n\t\t});\n\t},\n\tget_submodels: function(callback){\n\t\tthis.submodel = '';\n\t\tthis.configuration = this.parts = this.groups = [];\n\t\t$.ajax({\n\t\t\turl: API_DOMAIN + '/vehicle/' + this.year + '/' + this.make + '/' + this.model,\n\t\t\ttype:'get',\n\t\t\tdataType:'json',\n\t\t\tdata:{\n\t\t\t\tkey: API_KEY\n\t\t\t},\n\t\t\tsuccess: function(data, status, xhr){\n\t\t\t\tif(data.Matched.Parts !== null && data.Matched.Parts.length > 0){\n\t\t\t\t\tthis.parts = data.Matched.Parts;\n\t\t\t\t\tthis.groups = data.Matched.Groups;\n\t\t\t\t}\n\t\t\t\tif (data.ConfigOption !== undefined && data.ConfigOption.Options !== undefined && data.ConfigOption.Options.length > 0){\n\t\t\t\t\tcallback(data.ConfigOption.Options, null);\n\t\t\t\t}else{\n\t\t\t\t\tcallback([],\"Failed to retrieve vehicle sub models\");\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(xhr,status,err){\n\t\t\t\tcallback([],err);\n\t\t\t}\n\t\t});\n\t},\n\tget_configuration: function(callback){\n\t\tthis.parts = this.groups = [];\n\n\t\t// Build out API Endpoint\n\t\tpath = API_DOMAIN + '/vehicle/' + this.year + '/' + this.make +'/' + this.model + '/' + this.submodel;\n\n\t\t// Loop configuration options and append to\n\t\t// endpoint address\n\t\tfor (var i = this.configuration.length - 1; i >= 0; i--) {\n\t\t\tpath += '/' + this.configuration[i];\n\t\t};\n\n\t\t// Execute AJAX\n\t\t$.ajax({\n\t\t\turl: path,\n\t\t\ttype: 'get',\n\t\t\tdataType: 'json',\n\t\t\tdata:{\n\t\t\t\tkey: API_KEY\n\t\t\t},\n\t\t\tsuccess: function(data, status, xhr){\n\t\t\t\tif(data.Matched.Parts !== null && data.Matched.Parts.length > 0){\n\t\t\t\t\tthis.parts = data.Matched.Parts;\n\t\t\t\t\tthis.groups = data.Matched.Groups;\n\t\t\t\t}\n\t\t\t\tif (data.ConfigOption !== null && data.ConfigOption.Options !== null && data.ConfigOption.Options.length > 0){\n\t\t\t\t\tcallback(data.ConfigOption, null);\n\t\t\t\t}else{\n\t\t\t\t\tcallback([],\"Failed to retrieve vehicle configuration options\");\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(xhr, status, err){\n\t\t\t\tcallback([],err);\n\t\t\t}\n\t\t});\n\t}\n};"]],"start1":0,"start2":0,"length1":0,"length2":4360}]],"length":4360}
